generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Log {
  id Int @id @default(autoincrement())

  @@map("logs")
}

model Employee {
  id             Int             @id @default(autoincrement())
  username       String          @unique
  password       String
  firstName      String
  lastName       String
  email          String          @unique
  isActive       Boolean         @default(true)
  ipVerification Boolean         @default(true)
  profileImg     String?
  createdAt      DateTime        @default(now())
  createdBy      String
  authority      Authority       @default(MODERATOR)
  ipRequests     IPRequest[]
  verificatedIPs VerificatedIP[]

  @@map("employees")
}

model IPRequest {
  id         Int      @id @default(autoincrement())
  address    String
  employeeId Int
  createdAt  DateTime @default(now())
  createdBy  Employee @relation(fields: [employeeId], references: [id])

  @@map("ipRequests")
}

model VerificatedIP {
  id         Int      @id @default(autoincrement())
  address    String
  employeeId Int
  employee   Employee @relation(fields: [employeeId], references: [id])

  @@map("verificatedIPs")
}

model User {
  id             String              @id @default(uuid())
  username       String?             @unique
  password       String?
  firstName      String
  lastName       String
  email          String              @unique
  isActive       ClientIsActive
  lang           Lang                @default(EN)
  accountType    AccountType         @default(CLIENT)
  createdBy      CreatedByStrategies @default(LOCAL)
  creatorDetails CreatorDetails?
  refreshTokens  RefreshToken[]
  userDetails    UserDetails?

  @@map("users")
}

model UserDetails {
  id          Int          @id @default(autoincrement())
  userId      String       @unique
  profileImg  String?
  gender      Gender       @default(OTHER)
  createdAt   DateTime     @default(now())
  birthDate   DateTime?
  user        User         @relation(fields: [userId], references: [id])
  userAddress UserAddress?

  @@map("users_details")
}

model UserAddress {
  id            Int         @id @default(autoincrement())
  userDetailsId Int         @unique
  country       String?
  city          String?
  zipCode       Int?
  address1      String?
  address2      String?
  userDetails   UserDetails @relation(fields: [userDetailsId], references: [id])

  @@map("users_addresses")
}

model CreatorDetails {
  id          Int     @id @default(autoincrement())
  userId      String  @unique
  verificated Boolean @default(false)
  user        User    @relation(fields: [userId], references: [id])

  @@map("creator_details")
}

model RefreshToken {
  id        Int      @id @default(autoincrement())
  userId    String
  ipAddress String
  createdAt DateTime @default(now())
  token     String
  user      User     @relation(fields: [userId], references: [id])

  @@map("refresh_tokens")
}

enum Authority {
  ROOT
  ADMIN
  MODERATOR
  IT_SUPPORT
  DATA_SUPPORT
  CLIENT_SUPPORT
}

enum AccountType {
  CLIENT
  CREATOR
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

enum Lang {
  EN
  PL
}

enum ClientIsActive {
  IS_ACTIVE
  BLOCKED
  EMAIL_VERIFICATION
  PROFILE_NOT_COMPLETE
}

enum CreatedByStrategies {
  LOCAL
  FACEBOOk
  GOOGLE
}
